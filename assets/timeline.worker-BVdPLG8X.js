(function(){"use strict";self.onmessage=a=>{const{type:r,files:o,precision:s}=a.data;if(r==="BUILD")try{const e=new Map,n=new Map;for(const t of o){let i;for(const c of t.lines){if(c.date&&(i=c.date),!c.timestamp)continue;const l=u(c.timestamp,s);l&&(e.has(l)?i&&!n.has(l)&&n.set(l,i):(e.set(l,new Set),i&&n.set(l,i)),e.get(l).add(t.id))}}const m={type:"SUCCESS",timeline:Array.from(e.entries()).map(([t,i])=>{const c=n.get(t);return{timestamp:c?`${c} ${t}`:t,fileIds:Array.from(i)}}).sort((t,i)=>d(t.timestamp,i.timestamp))};self.postMessage(m)}catch(e){const n={type:"ERROR",error:e.message||"Unknown error during timeline build"};self.postMessage(n)}};function u(a,r){const o=a.split(":");if(o.length<3)return a;const s=o[0],e=o[1],n=o[2];if(r===5)return`${s}:${e}`;if(r===4){const c=n.charAt(0);return`${s}:${e}:${c}`}const f=n.split("."),m=f[0],t=f[1]||"";if(r===0)return`${s}:${e}:${m}`;const i=t.substring(0,r);return i.length>0?`${s}:${e}:${m}.${i}`:`${s}:${e}:${m}`}function d(a,r){const o=a.includes(" "),s=r.includes(" ");if(o&&s){const e=new Date(a).getTime(),n=new Date(r).getTime();if(!isNaN(e)&&!isNaN(n))return e-n}return p(a)-p(r)}function p(a){let r=a,o="";if(a.includes(" ")){const t=a.split(" ");r=t[t.length-1],o=t.slice(0,t.length-1).join(" ")}const s=r.split(":"),e=parseInt(s[0]||"0",10),n=parseInt(s[1]||"0",10);let f=0;if(s.length>2){const t=s[2];if(t.includes(".")){const[i,c]=t.split(".");f=parseInt(i,10);const l=parseFloat(`0.${c}`);f+=l}else f=parseInt(t,10)}let m=e*3600+n*60+f;if(o){const t=Date.parse(o);if(!isNaN(t))return t/1e3+m}return m}})();
